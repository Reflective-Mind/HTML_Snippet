<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
        name="description"
        content="HTML Snippet Builder - Create and manage HTML content"
    />
    <link rel="apple-touch-icon" href="/logo192.png" />
    <link rel="manifest" href="/manifest.json" crossorigin="use-credentials" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css">
    <title>HTML Snippet Builder</title>
    <script>
        // Handle errors globally
        window.addEventListener('error', function(e) {
            console.warn('Caught error:', e.message);
            // Prevent app from completely breaking on errors
            return true;
        });
        
        // Fallback for missing elements
        document.addEventListener('DOMContentLoaded', function() {
            if (!document.getElementById('root')) {
                console.error('Root element not found, creating fallback UI');
                const fallbackUI = document.createElement('div');
                fallbackUI.id = 'root';
                fallbackUI.innerHTML = `
                    <div class="container mt-5">
                        <div class="row">
                            <div class="col-md-8 offset-md-2">
                                <div class="card">
                                    <div class="card-header bg-primary text-white">
                                        <h2 class="text-center">HTML Snippet Builder</h2>
                                    </div>
                                    <div class="card-body">
                                        <div class="alert alert-info">
                                            <p>Loading application... If this message persists, please check your browser console for errors.</p>
                                        </div>
                                        <div class="d-grid gap-3 mt-4">
                                            <a href="/" class="btn btn-outline-primary">Return to Home</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                document.body.appendChild(fallbackUI);
            }
        });
        
        // Global API URL for all fetch calls
        window.API_BASE_URL = 'https://mbti-render.onrender.com';
        
        // Global initialization for navigation functions
        window.isPreviewMode = false;
        window.getAvailablePages = function() {
            // Will be overwritten by the app
            return [];
        };
        window.navigateToPage = function(pageId) {
            console.log("Navigation placeholder to:", pageId);
            // Will be overwritten by the app
        };
        
        // Define setupEventDelegation as a fallback
        if (typeof setupEventDelegation === 'undefined') {
            window.setupEventDelegation = function() {
                console.log('Using fallback event delegation setup');
            };
        }
        
        // Define setupGlobalHelpers as a fallback
        if (typeof setupGlobalHelpers === 'undefined') {
            window.setupGlobalHelpers = function() {
                console.log('Using fallback global helpers setup');
            };
        }
        
        // Define setupDragAndResize as a fallback
        if (typeof setupDragAndResize === 'undefined') {
            window.setupDragAndResize = function() {
                console.log('Using fallback drag and resize setup');
            };
        }
    </script>
</head>
<body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root" class="container-fluid p-0">
        <!-- Initial loader will be replaced by app.js -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3">Loading application...</p>
        </div>
    </div>
    
    <!-- Alert container for notifications -->
    <div id="alert-container" style="position: fixed; top: 20px; right: 20px; z-index: 9999; width: 350px;"></div>
    
    <!-- Add necessary DOM elements that might be missing -->
    <div id="login-form-container" style="display: none;" class="container mt-4">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <div class="card">
                    <div class="card-header">
                        <h3>Login</h3>
                    </div>
                    <div class="card-body">
                        <form id="login-form">
                            <div class="mb-3">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" class="form-control" id="email" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Password</label>
                                <input type="password" class="form-control" id="password" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Login</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="admin-panel" style="display: none;"></div>
    <div id="public-view" style="display: none;"></div>
    <div id="admin-toolbar" style="display: none;" class="p-2 bg-light"></div>
    <div id="pages-nav" style="display: none;" class="page-navigation"></div>
    <div id="content" style="display: none;"></div>
    <div id="public-content" style="display: none;"></div>
    
    <!-- Bootstrap and application scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/app.js" onerror="console.error('Failed to load app.js')"></script>
</body>
</html> 